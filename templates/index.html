<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¤ãƒ¯ã‚·tube</title>
<link rel="stylesheet" href="/static/style.css">
</head>
<body>

<header class="glass">
  <h1>ğŸŸ ã‚¤ãƒ¯ã‚·tube</h1>
  <input id="q" placeholder="å‹•ç”»ã‚’æ¤œç´¢">
  <button onclick="search()">æ¤œç´¢</button>
</header>

<div id="results"></div>

<script>
function alertMsg(msg){
  const a=document.createElement("div");
  a.className="alert";
  a.textContent=msg;
  document.body.appendChild(a);
  setTimeout(()=>a.remove(),3000);
}

async function search(){
  const q=document.getElementById("q").value;
  if(!q) return alertMsg("æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ã­");
  try{
    const r=await fetch(`/api/search?q=${encodeURIComponent(q)}`);
    if(!r.ok) throw "";
    const data=await r.json();
    const box=document.getElementById("results");
    box.innerHTML="";
    data.forEach(v=>{
      const c=document.createElement("div");
      c.className="glass card";
      c.innerHTML=`
        <a href="/watch/${v.videoId}">
          <img src="https://i.ytimg.com/vi/${v.videoId}/hqdefault.jpg">
          <p>${v.title}</p>
        </a>`;
      box.appendChild(c);
    });
  }catch{
    alertMsg("æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ");
  }
}
</script>

</body>
</html>
